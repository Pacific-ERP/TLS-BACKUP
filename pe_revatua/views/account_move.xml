<?xml version="1.0" encoding="utf-8" ?>
<odoo><data>
    <!-- Form -->
    <record id="revatua_account_move_form" model="ir.ui.view">
        <field name="name">Pacific-ERP account.move : pe_revatua (form)</field>
        <field name="model">account.move</field>
        <field name="inherit_id" ref="account.view_move_form" />
        <field name="groups_id" eval="[(6, 0, [ref('pe_revatua.group_revatua_users') ])]"/>
        <field name="arch" type="xml">
        <!-- Form -->
            <!-- Coche Revatua -->
            <xpath expr="//page[@name='other_info']//field[@name='company_id']" position="after">
                <field name="revatua_ck" groups="base.group_no_one"/>
            </xpath>
            <!-- Somme de la facture -->
            <xpath expr="//form[1]/sheet[1]/notebook[1]/page[1]/group[1]/group[1]/field[@name='narration']" position="after">
                <field name="sum_customer" attrs="{'invisible': [('revatua_ck', '=', False)]}"/>
                <field name="sum_adm" attrs="{'invisible': [('revatua_ck', '=', False)]}"/>
                <field name="is_adm_invoice" attrs="{'invisible': [('revatua_ck', '=', False)]}"/>
            </xpath>
             <!-- champs custom revatua -->
            <xpath expr="//group[@id='header_right_group']" position="after">
                <group name="lieu_recuperation" string="Lieu de récupération" attrs="{'invisible': [('revatua_ck', '=', False)]}">
                    <field name="commune_recup"/>
                    <field name="ile_recup"/>
                    <field name="contact_expediteur"/>
                    <field name="tel_expediteur" attrs="{'invisible': ['&amp;',['tel_expediteur','=',False],['mobil_expediteur','!=',False]]}"/>
                    <field name="mobil_expediteur" attrs="{'invisible': ['|',['tel_expediteur','!=',False],['mobil_expediteur','=',False]]}"/>
                </group>
                <group name="lieu_destinataire" string="Destinataire" attrs="{'invisible': [('revatua_ck', '=', False)]}">
                    <field name="commune_dest"/>
                    <field name="ile_dest"/>
                    <field name="contact_dest"/>
                    <field name="tel_dest" attrs="{'invisible': ['&amp;',['tel_dest','=',False],['mobil_dest','!=',False]]}"/>
                    <field name="mobil_dest" attrs="{'invisible': ['|',['tel_dest','!=',False],['mobil_dest','=',False]]}"/>
                </group>
            </xpath>
        <!-- ligne d'article -->
            <!-- Modification du label Quantité en Qté -->
            <xpath expr="//form[1]/sheet[1]/notebook[1]/page[1]/field[@name='invoice_line_ids']/tree[1]/field[@name='quantity']" position="attributes">
                <attribute name="string">Qté</attribute>
                <attribute name="digits">[12,3]</attribute>
            </xpath>
            <!-- Modification du label Prix en Total HT -->
            <xpath expr="//form[1]/sheet[1]/notebook[1]/page[1]/field[@name='invoice_line_ids']/tree[1]/field[@name='price_unit']" position="attributes">
                <attribute name="string">Prix U</attribute>
            </xpath>
            
            <!-- Modification du lable Total en Total TTC -->
            <xpath expr="//form[1]/sheet[1]/notebook[1]/page[1]/field[@name='invoice_line_ids']/tree[1]/field[@name='price_subtotal']" position="attributes">
                <attribute name="string">Total HT</attribute>
            </xpath>
            
            <!-- Ajout des champs Maritime/Terrestre/RPA -->
            <xpath expr="//form[1]/sheet[1]/notebook[1]/page[1]/field[@name='invoice_line_ids']/tree[1]/field[@name='price_subtotal']" position="after">
                <!-- Invisible -->
                <field name="base_rpa" optional="hide"/>
                <field name="tarif_minimum_rpa" optional="hide"/>
                <field name="base_maritime" optional="hide"/>
                <field name="tarif_minimum_maritime" optional="hide"/>
                <field name="base_terrestre" optional="hide"/>
                <field name="tarif_minimum_terrestre" optional="hide"/>
                <field name="tarif_minimum" optional="hide"/>
                <field name="check_adm" optional="hide"/>
                <!-- Afficher -->
                <field name="tarif_terrestre" sum="Terrestre" digits="[42,0]" optional="show" attrs="{'column_invisible': [('parent.revatua_ck', '=', False)]}"/>
                <field name="tarif_maritime" sum="Maritime" digits="[42,0]" optional="show" attrs="{'column_invisible': [('parent.revatua_ck', '=', False)]}"/>
                <field name="tarif_rpa" sum="RPA" digits="[42,0]" optional="show" attrs="{'column_invisible': [('parent.revatua_ck', '=', False)]}"/>
                <field name="tarif_rpa_ttc" sum="RPA" digits="[42,0]" optional="hide" attrs="{'column_invisible': [('parent.revatua_ck', '=', False)]}"/>
                <field name="price_total" optional="show" string="Total TTC" attrs="{'column_invisible': [('parent.revatua_ck', '=', False)]}"/>
            </xpath>
            
            <!-- Rajouter les notions de poids/volumes -->
            <xpath expr="//page[1]/field[@name='invoice_line_ids']/tree[1]/field[@name='product_uom_id']" position="after">
                <field name="r_volume" string="Vol(m³)" optional="show" attrs="{'column_invisible': [('parent.revatua_ck', '=', False)]}"/>
                <field name="r_weight" string="Poids(T)" optional="show" attrs="{'column_invisible': [('parent.revatua_ck', '=', False)]}"/>
            </xpath>
            <!-- Ajout des champs sur le deuxieme onglet pour sauvegarde -->
            <xpath expr="//form[1]/sheet[1]/notebook[1]/page[2]/field[@name='line_ids']/tree[1]/field[@name='account_id']" position="after">
                <field name="r_volume" invisible="1"/>
                <field name="r_weight" invisible="1"/>
                <field name="base_rpa" invisible="1"/>
                <field name="tarif_minimum_rpa" invisible="1"/>
                <field name="base_maritime" invisible="1"/>
                <field name="tarif_maritime" invisible="1"/>
                <field name="tarif_minimum_maritime" invisible="1"/>
                <field name="base_terrestre" invisible="1"/>
                <field name="tarif_terrestre" invisible="1"/>
                <field name="tarif_minimum_terrestre" invisible="1"/>
                <field name="tarif_minimum" invisible="1"/>
                <field name="check_adm" invisible="1"/>
                <field name="tarif_rpa" invisible="1"/>
                <field name="tarif_rpa_ttc" invisible="1"/>
            </xpath>
    </field></record>
</data></odoo>