<?xml version="1.0" encoding="utf-8" ?>
<odoo><data>
<!--     Form      -->
    <record id="pe_crm_account_inherit_form_view" model="ir.ui.view">
        <field name="name">pe.crm.account.inherit.form.view</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_lead_view_form" />
        <field name="arch" type="xml">
            <!-- modification avec xpath  // recherche sur tout le documents -->
            <xpath expr="//form[1]/sheet[1]/notebook[1]" position="inside">
                <page string="Factures">
                  <field name='invoice_ids'>
                  </field>
                </page>
                <page string="Achats">
                  <field name='purchase_ids'>
                  </field>
                </page>
            </xpath>
            <xpath expr="//header" position="inside">
                <button string="Nouvel Achat" name="action_purchase_quotations_new" type="object" class="oe_highlight" attrs="{'invisible': ['|', ('type', '=', 'lead'), '&amp;', ('probability', '=', 0), ('active', '=', False)]}"/>
            </xpath>
        </field>
    </record>
<!--     List      -->
<!--     <record id="pe_crm_account_inherit_list_view" model="ir.ui.view">
        <field name="name">pe.crm.account.inherit.list.view</field>
        <field name="model">crm.lead</field>
        <field name="inherit_id" ref="crm.crm_case_tree_view_oppor" />
        <field name="arch" type="xml">
            <xpath expr="//field[@name='name']" position="after">
                <field name="invoice_ids" widget="many2many_tags"/>
            </xpath>
        </field>
        </record> -->
    
    <!-- action de renvoie vers la création d'une facture (repris de la création d'un devis) Créer/Visualiser --> 
    <record id="purchase_action_quotations_new" model="ir.actions.act_window">
        <field name="name">CRM : Création d'un Achat</field>
        <field name="res_model">purchase.order</field>
        <field name="view_mode">form,tree,graph</field>
        <field name="domain">[('opportunity_id', '=', active_id)]</field>
        <field name="context">{'search_default_opportunity_id': active_id, 'default_opportunity_id': active_id}</field>
    </record>
    
</data></odoo>